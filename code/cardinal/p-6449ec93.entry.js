import{r as e,c as s,h as t,g as i}from"./p-1c0c10bb.js";const a=class{constructor(t){e(this,t),this.giveMeSeed=s(this,"giveMeSeed",7)}componentDidLoad(){let e=this.element.querySelector("iframe");window.document.addEventListener(this.digestSeedHex,s=>{const t=s.detail||{};"seed"!==t.query?"completed"===t.status&&e.contentWindow.location.reload():e.contentWindow.document.dispatchEvent(new CustomEvent(this.digestSeedHex,{detail:{seed:this.seed}}))},!0)}getSWOnMessageHandler(){return this.onServiceWorkerMessageHandler||(this.onServiceWorkerMessageHandler=e=>{e.data&&"seed"===e.data.query&&e.data.identity===this.digestSeedHex&&e.source.postMessage({seed:this.seed})}),this.onServiceWorkerMessageHandler}connectedCallback(){navigator.serviceWorker.addEventListener("message",this.getSWOnMessageHandler())}disconnectedCallback(){navigator.serviceWorker.removeEventListener("message",this.getSWOnMessageHandler())}componentWillLoad(){return new Promise(e=>{this.giveMeSeed.emit({appName:this.appName,callback:(s,t)=>{if(s)throw s;this.seed=t,this.digestSeedHex=this.digestMessage(t),e()}})})}digestMessage(e){return require("pskcrypto").pskHash(e,"hex")}render(){let e=window.top.location.href;return"/"!==e[e.length-1]&&(e+="/"),t("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms","landing-page":this.landingPath,frameborder:"0",style:{overflow:"hidden",height:"100%",width:"100%"},src:e+"iframe/"+this.digestSeedHex})}get element(){return i(this)}};export{a as psk_ss_app}