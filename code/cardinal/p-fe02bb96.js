import{g as e}from"./p-1c0c10bb.js";import{b as t,c as n}from"./p-4a6e3791.js";import{a as i,c as r}from"./p-1dd23f18.js";function l(e,i){if(i.hasAttribute(t)){let n=i.getAttribute(t).trim();return void 0!==e.getChainValue(n)}if(i.hasAttribute(n)){let t=i.getAttribute(n).split("|");if(2!==t.length)return!1;let r=t[0].trim();return t[1].trim()===e.getChainValue(r)}return!0}function o(e){let t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))}function a(e,t,n,r){let l=this;Array.from(r.attributes).filter(e=>e.name.startsWith(n)).forEach(o=>{const a=o.name.split(n)[1],u=i(a),c=e?`${e}.${o.value}`:o.value,f=t.getChainValue(c);r.setAttribute(a,f),l[u]=t.getChainValue(c)})}function u(e,t,n,r){let l=this;Array.from(r.attributes).filter(e=>e.value.startsWith(n)).forEach(o=>{const a=o.value.split(n)[1],u=e?`${e}.${a}`:a,c=i(o.name);if(t.hasExpression(u))l[c]=t.evaluateExpression(u),t.onChangeExpressionChain(u,(function(){l[c]=t.evaluateExpression(u)}));else{const e=t.getChainValue(u);r.setAttribute(o.name,e),l[c]=e,t.onChange(u,(function(){l[c]=t.getChainValue(u)}))}})}function c(e,t){try{let n=this;if(n.rootModel){let i=e;return n.parentChain&&(i=`${n.parentChain}.${e}`),n.rootModel.setChainValue(i,t),!0}return!1}catch(n){console.error(n)}return!1}function f(t,n,i){if(t||!n)return i();let r,o,c,f=this,d=e(f);if(!l(n,d))return d.setAttribute("data-hide","hide"),i();if(d.removeAttribute("data-hide"),null!==d.getAttribute("data-view-model")&&"psk-for-each"===d.tagName.toLowerCase())return r=d.getAttribute("data-view-model"),c=r,f.__assignProperties.call(f,{rootModel:n,parentChain:c}),i();if(r=d.getAttribute("view-model"),c=r,null===r&&(o=null===d.getAttribute("name")||d.getAttribute("name").startsWith("@")?null:d.getAttribute("name"),null!==o||null===d.getAttribute("label")||d.getAttribute("label").startsWith("@")||(o=d.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),c=o),!r&&!o)return u.call(f,c,n,"@",d,i),a.call(f,c,n,"view-model-",d,i),i();function s(e,t){f[e]=n.getChainValue(t),n.onChange(t,(function(){f[e]=n.getChainValue(t)}))}if(f.__assignProperties.call(f,{rootModel:n,parentChain:c}),r){let e=n.getChainValue(c);return e?(Object.keys(e).forEach(e=>{s(e,`${c}.${e}`)}),function(){const e=c+".value";if(!n.getChainValue(c)||n.getChainValue(e))return i();s("value",e)}(),i()):i()}return i()}function d(){return t=>{let{componentWillLoad:n,render:i}=t;t.render=function(){let t=e(this),n=t.className;return t.className="hide"===t.getAttribute("data-hide")?n+" hidden":n.replace(" hidden",""),i&&i.call(this)},t.componentWillLoad=function(){let t=this,i=e(t);return t.changeModel=c,t.__assignProperties=o,i.isConnected?0===i.getAttributeNames().filter(e=>"data-view-model"===e.toLowerCase()||e.toLowerCase().includes("view-model")||i.getAttribute(e).toLowerCase().startsWith("@")).length?n&&n.call(t):new Promise(e=>{var l;l=()=>{e(n&&n.call(t))},r("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(e,n){f.apply(t,[e,n,l])}}},!0,i)}):n&&n.call(t)}}}export{d as B,l as _}